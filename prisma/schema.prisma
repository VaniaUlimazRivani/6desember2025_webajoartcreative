// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url       = env("DATABASE_URL")
}

// Tabel Admin
model Admin {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  password  String
  email     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Tabel Kategori
model Kategori {
  id        Int      @id @default(autoincrement())
  nama      String   @unique
  produk    Produk[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Tabel Produk
model Produk {
  id              Int             @id @default(autoincrement())
  nama            String
  harga           Float
  stok            Int             // Wajib diisi saat POST
  deskripsi       String?         @db.Text
  gambar          String?
  kategoriId      Int             // Wajib, harus ada ID kategori yang valid
  kategori        Kategori        @relation(fields: [kategoriId], references: [id])
  transaksiItems  TransaksiItem[]
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  deletedAt       DateTime?       // <--- TAMBAHKAN DI SINI
}

// Tabel Testimoni
model Testimoni {
  id        Int      @id @default(autoincrement())
  name      String
  text      String   @db.Text
  rating    Int
  status    String   @default("Pending")
  date      DateTime @default(now())
}

// Tabel Transaksi
model Transaksi {
  id          Int             @id @default(autoincrement())
  tanggal     DateTime        @default(now())
  status      String          @default("Selesai")
  totalHarga  Float
  items       TransaksiItem[]
}

// Pivot Transaksi Items
model TransaksiItem {
  id          Int       @id @default(autoincrement())

  transaksiId Int
  transaksi   Transaksi @relation(fields: [transaksiId], references: [id], onDelete: Cascade)

  produkId    Int
  produk      Produk    @relation(fields: [produkId], references: [id])

  jumlah      Int
  hargaSatuan Float
}

// Konten Website
model KontenWebsite {
  id    Int    @id @default(autoincrement())
  key   String @unique
  value String @db.Text
  label String?
}